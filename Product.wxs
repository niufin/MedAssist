<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs" xmlns:ui="http://wixtoolset.org/schemas/v4/wxs/ui">
  <Package Name="MedAssist" Manufacturer="Niufin" Version="1.4.0.1" UpgradeCode="a2b3c4d5-e6f7-48a9-b0c1-d2e3f4050607">
    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
    
    <MediaTemplate EmbedCab="yes" />

    <StandardDirectory Id="ProgramFiles64Folder">
      <Directory Id="INSTALLFOLDER" Name="MedAssist" />
    </StandardDirectory>

    <StandardDirectory Id="ProgramMenuFolder">
      <Directory Id="ApplicationProgramsFolder" Name="MedAssist"/>
    </StandardDirectory>

    <ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">
      <Files Include="wpf_app\NiufinDoctorWPF\bin\Release\net8.0-windows\win-x64\publish\**\*.*" />

      <Component Id="StartMenuShortcut" Directory="ApplicationProgramsFolder" Guid="b1c2d3e4-f5a6-47b8-c9d0-e1f203040506">
        <Shortcut Id="ApplicationStartMenuShortcut"
                  Name="MedAssist"
                  Target="[INSTALLFOLDER]MedAssist.exe"
                  WorkingDirectory="INSTALLFOLDER"
                  Icon="icon.ico"
                  Advertise="no" />
        <RemoveFolder Id="CleanUpShortCut" Directory="ApplicationProgramsFolder" On="uninstall"/>
        <RegistryValue Root="HKCU" Key="Software\Niufin\MedAssist" Name="installed" Type="integer" Value="1" KeyPath="yes" />
      </Component>
    </ComponentGroup>

    <Icon Id="icon.ico" SourceFile="wpf_app\NiufinDoctorWPF\icon.ico"/>
    <Property Id="ARPPRODUCTICON" Value="icon.ico" />

    <Feature Id="ProductFeature" Title="MedAssist" Level="1">
      <ComponentGroupRef Id="ProductComponents" />
    </Feature>
    
    <ui:WixUI Id="WixUI_Minimal" />
    <WixVariable Id="WixUILicenseRtf" Value="license.rtf" />

  </Package>
</Wix>
